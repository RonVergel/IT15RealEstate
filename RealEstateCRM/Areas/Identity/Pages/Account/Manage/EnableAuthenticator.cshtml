@page
@model RealEstateCRM.Areas.Identity.Pages.Account.Manage.EnableAuthenticatorModel
@{
    ViewData["Title"] = "Configure authenticator app";
    ViewData["ActivePage"] = ManageNavPages.TwoFactorAuthentication;
}

<section class="bg-white border border-gray-200 rounded-lg p-6">
    <h1 class="text-xl font-semibold text-gray-900 mb-2">Configure authenticator app</h1>
    <p class="text-sm text-gray-600 mb-4">Use an authenticator like Microsoft or Google Authenticator.</p>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="lg:col-span-2 space-y-4">
            <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                <div class="text-sm text-gray-600 mb-2">Account key (enter this in your app)</div>
                <div class="flex items-center gap-3">
                    <code id="shared-key" class="px-3 py-2 bg-white border rounded text-sm font-mono tracking-widest">@Model.SharedKey</code>
                    <button type="button" class="px-2 py-1 text-xs border rounded" onclick="navigator.clipboard.writeText(document.getElementById('shared-key').innerText)">Copy</button>
                </div>
                <div class="text-xs text-gray-500 mt-2">Issuer: Homey • Digits: 6 • Period: 30s</div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200 flex items-center justify-center">
                    @if (!string.IsNullOrWhiteSpace(Model.QrCodeDataUrl))
                    {
                        <img src="@Model.QrCodeDataUrl" alt="Scan QR with Authenticator" class="w-48 h-48 object-contain" />
                    }
                    else
                    {
                        <div class="text-sm text-gray-600">QR code not available.</div>
                    }
                </div>
                <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                    <div class="text-sm text-gray-600 mb-2">Alternate setup (URI)</div>
                    <div class="text-xs text-gray-700 break-all">@Model.AuthenticatorUri</div>
                </div>
            </div>

            <form method="post" class="space-y-3">
                <div>
                    <label class="block text-sm text-gray-700 mb-1">Verification Code</label>
                    <input asp-for="Input.VerificationCode" class="w-56 border rounded px-3 py-2 text-sm" placeholder="123 456" />
                    <span asp-validation-for="Input.VerificationCode" class="text-xs text-red-600"></span>
                </div>
                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Verify & Enable</button>
            </form>
        </div>

        <aside class="lg:col-span-1 space-y-3">
            <div class="p-4 border border-emerald-200 bg-emerald-50 rounded">
                <div class="text-sm font-medium text-emerald-800">Tips</div>
                <ul class="mt-2 text-xs text-emerald-800 list-disc list-inside space-y-1">
                    <li>Spaces and casing do not matter.</li>
                    <li>Keep recovery codes safe after enabling.</li>
                </ul>
            </div>
        </aside>
    </div>
</section>

@section Scripts { <partial name="_ValidationScriptsPartial" /> }

